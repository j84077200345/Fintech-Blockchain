web3 = new Web3(new Web3.providers.HttpProvider("http://localhost:8545"));
abi = JSON.parse(getAbi());
KycContract = web3.eth.contract(abi);

var oname = window.localStorage.getItem('oname');
// In your nodejs console, execute contractInstance.address to get the address at which the contract is deployed and change the line below to use your deployed address
contractInstance = KycContract.at(getAddress());
$(document).ready(function() {
  customersCount = contractInstance.getCustomersCount();
  console.log(customersCount);
  
  for(var i=0;i<customersCount;i++) {
  	var date = new Date();
  	var customerData = contractInstance.getCustomerData(oname,i);
	  console.log(customerData[2]);
	  if(customerData[2]!='0x0000000000000000000000000000000000000000000000000000000000000000') {
		let dataHash = contractInstance.getDataHash(i);
		let name = web3.toAscii(customerData[0]);
		let email = web3.toAscii(customerData[1]);
		let phone = web3.toAscii(customerData[2]);
		let drivers = web3.toAscii(customerData[3]);
		let aadhar = web3.toAscii(customerData[4]);
		let pan = web3.toAscii(customerData[5]);
		$("#box").append('<i class="anticon anticon-down" style="display: block; font-size: 24pt; margin-bottom: 27px;"></i> <div class="ant-card genesis block block-shadow ant-card-bordered"> <div class="ant-card-body"> <div> <span class="ant-input-group-wrapper" style="margin-bottom: 20px;"> <span class="ant-input-wrapper ant-input-group"> <span class="ant-input-group-addon"> <span style="margin-right: 7px; margin-left: 7px;">NAME</span> </span> <span class="genesis-data genesis-mutate genesis-mutate-2 ant-input-affix-wrapper"> <span class="ant-input-prefix"> <i class="anticon anticon-file-text"></i> </span> <span class="ant-input">'+name+' </span> </span> </span> <div class="genesis-previous-hash" style="margin-bottom: 7px; display: flex; justify-content: flex-start; flex-wrap: nowrap; max-width: 100%; overflow: auto;"> <div style="white-space: nowrap;">PREVIOUS HASH</div> <div data-show="true" class="ant-tag ant-tag-green" style="font-size: 8pt; float: right; font-family: &quot;Courier New&quot;; cursor: default; display: block; background: none; border-color: transparent;"> <span class="ant-tag-text">0</span> </div> </div> <div class="genesis-hash genesis-hash-2 genesis-hash-3" style="display: flex; justify-content: flex-start; flex-wrap: nowrap; max-width: 100%; overflow: auto;"> <div style="margin-right: 15px;">HASH</div> <div data-show="true" class="ant-tag ant-tag-green" style="display: block; font-size: 9pt; font-family: &quot;Courier New&quot;; cursor: default; max-width: 100%; overflow: auto;"> <span class="ant-tag-text">'+dataHash+'</span> </div> </div> <div style="margin-top: 27px; display: flex; justify-content: space-between; align-items: center; flex-wrap: nowrap; text-overflow: ellipsis;"> <div style="font-size: 24px; white-space: nowrap; overflow: auto;"> <span class="genesis-index" style="letter-spacing: 1px;">BLOCK #' + i + '</span> <span class="genesis-timestamp"> <span style="font-weight: 300; font-size: 8pt;">on '+ date + '</span> </span> </div> <div data-show="true" class="ant-tag genesis-mine genesis-nonce" style="cursor: default;"> <span class="ant-tag-text" href="#collapsedDiv' + i + '" data-toggle="collapse">More</span> </div> </div> <div id="collapsedDiv' + i + '" class="collapse"> <div> <span class="ant-input-group-wrapper" style="margin-bottom: 20px;"> <span class="ant-input-wrapper ant-input-group"> <span class="ant-input-group-addon"> <span style="margin-right: 7px; margin-left: 7px;">Aadhar Number </span> </span> <span class="genesis-data genesis-mutate genesis-mutate-2 ant-input-affix-wrapper"> <span class="ant-input-prefix"><i class="anticon anticon-file-text"></i></span> <span type="text" class="ant-input">'+aadhar+'</span></span> </span> </span> </div> <div> <span class="ant-input-group-wrapper" style="margin-bottom: 20px;"> <span class="ant-input-wrapper ant-input-group"> <span class="ant-input-group-addon"> <span style="margin-right: 7px; margin-left: 7px;">Driving Licence Number </span> </span> <span class="genesis-data genesis-mutate genesis-mutate-2 ant-input-affix-wrapper"> <span class="ant-input-prefix"><i class="anticon anticon-file-text"></i></span> <span type="text" class="ant-input">'+drivers+'</span> </span> </span> </span> </div> <div> <span class="ant-input-group-wrapper" style="margin-bottom: 20px;"> <span class="ant-input-wrapper ant-input-group"> <span class="ant-input-group-addon"> <span style="margin-right: 7px; margin-left: 7px;">PAN</span> </span> <span class="genesis-data genesis-mutate genesis-mutate-2 ant-input-affix-wrapper"> <span class="ant-input-prefix"><i class="anticon anticon-file-text"></i></span> <span type="text" class="ant-input"> '+pan+'</span></span> </span> </span> </div> <div> <span class="ant-input-group-wrapper" style="margin-bottom: 20px;"> <span class="ant-input-wrapper ant-input-group"> <span class="ant-input-group-addon"> <span style="margin-right: 7px; margin-left: 7px;">E-mail ID</span> </span> <span class="genesis-data genesis-mutate genesis-mutate-2 ant-input-affix-wrapper"> <span class="ant-input-prefix"><i class="anticon anticon-file-text"></i></span> <span type="text" class="ant-input">'+email+'</span> </span> </span> </span> </div> <div> <span class="ant-input-group-wrapper" style="margin-bottom: 20px;"> <span class="ant-input-wrapper ant-input-group"> <span class="ant-input-group-addon"> <span style="margin-right: 7px; margin-left: 7px;">Mobile Number</span> </span> <span class="genesis-data genesis-mutate genesis-mutate-2 ant-input-affix-wrapper"> <span class="ant-input-prefix"><i class="anticon anticon-file-text"></i></span> <span type="text" class="ant-input">'+phone+'</span> </span> </span> </span> </div> <div style="margin-left:45%"> <button type="button" class="press ant-btn mine-button animate"> <i class="anticon anticon-plus"></i> <span onclick="verify()" style="margin-left: 7.5px; color: white;">Verify</span> </button> </div> </div> </div> </div> </div>');  
	  }
  	
  	
  }	  
});
